#+TITLE: Command Interpreter Configuration
#+AUTHOR: Joseph M LaFreniere (lafrenierejm)
#+EMAIL: joseph@lafreniere.xyz
#+PROPERTY: header-args+ :tangle no

* Introductory Boilerplate                                         :noexport:
  #+HEADER: :comments no
  #+HEADER: :padline no
  #+BEGIN_SRC emacs-lisp :tangle yes
    ;;; init-comint.el --- Configure command interpreter

    ;; Copyright (C) Joseph M LaFreniere (lafrenierejm)

    ;; Author: Joseph LaFreniere <joseph@lafreniere.xyz>
    ;; Keywords: processes
    ;; Version 1.0
    ;; Package-Requires: ((comint) (general) (use-package))

    ;; This file is not part of GNU Emacs.

    ;; Init Comint is free software: you can redistribute it and/or modify it under
    ;; the terms of the GNU General Public License as published by the Free Software
    ;; Foundation, either version 3 of the License, or (at your option) any later
    ;; version.

    ;; Init Comint is distributed in the hope that it will be useful, but WITHOUT
    ;; ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
    ;; FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more
    ;; details.

    ;; You should have received a copy of the GNU General Public License along with
    ;; GNU Emacs.  If not, see <https://www.gnu.org/licenses/>.

    ;;; Commentary:

    ;; This file is tangled from init-comint.org.  Changes made here will
    ;; be overwritten by changes to that Org file.

    ;;; Code:
  #+END_SRC

* Dependencies
  #+BEGIN_SRC emacs-lisp :tangle yes :padline no
    (require 'general)
    (require 'use-package)
  #+END_SRC

* Comint
  #+BEGIN_SRC emacs-lisp :tangle yes :noweb yes
    (use-package comint
      :straight nil

      :demand

      :commands
      (init-comint/clear-buffer)

      :general
      <<comint/general>>

      :config
      <<comint/config>>)
  #+END_SRC

** Keybindings
   :PROPERTIES:
   :HEADER-ARGS+: :noweb-ref comint/general
   :END:

   Use =C-l= to clear the current buffer.

   #+BEGIN_SRC emacs-lisp
     (:keymaps 'comint-mode-map
      "C-l" #'init-comint/clear-buffer)
   #+END_SRC

** Post-Load Evaluation
   :PROPERTIES:
   :HEADER-ARGS+: :noweb-ref comint/config
   :END:

*** Clear Buffers
    The following code is taken verbatim from [[https://emacsredux.com/blog/2015/01/18/clear-comint-buffers/]["Clear Comint Buffers"]] on /Emacs Redux/.
    The only addition is the doc string.

    #+BEGIN_SRC emacs-lisp
      (defun init-comint/clear-buffer ()
	"Clear all scrollback for the current buffer."
	(interactive)
	(let ((comint-buffer-maximum-size 0))
	  (comint-truncate-buffer)))
    #+END_SRC

* Ending Boilerplate                                               :noexport:
  #+BEGIN_SRC emacs-lisp :tangle yes
    (provide 'init-comint)
    ;;; init-comint.el ends here
  #+END_SRC
